// ============================================================================
// VIADEO GRAPH API CONNECTOR -- NODE.JS FRAMEWORK FOR A BETTER WORLD WITH APIs
//                   XLP - eXecution and Loading Planner
// ============================================================================
//             www.viadeo.com - api.video.com - dev.viadeo.com
//
//             Copyright (C) Viadeo 2011 - All rights reserved
// ============================================================================
//
// - Some cryptographics
//
// @author Lo√Øc Dias Da Silva <ldiasdasilva@viadeoteam.com> 
// ============================================================================

var crypto = require('crypto');

var cryptoUserPass = null;
var cryptoAlgo     = null; // openssl -h for the list of supported algorithms

// ----------------------------------------------------------------------------

var configure = exports.configure = function(_cryptoUserPass, _cryptoAlgo) {
    cryptoUserPass = _cryptoUserPass || cryptoUserPass || 'E5h4340BJ9S2i2h2uRtmY8Q66QWH';
    cryptoAlgo     = _cryptoAlgo || cryptoAlgo || 'aes-128-ecb';
};

// ----------------------------------------------------------------------------

exports.encode = function(id, algo) {
    configure();
    var cipher = crypto.createCipher(algo || cryptoAlgo, cryptoUserPass);
    var crypted = cipher.update(id,'utf8','hex');
    crypted += cipher.final('hex');

    return crypted;
};

exports.decode = function(idCode, algo) {
    configure();
    var decipher = crypto.createDecipher(algo || cryptoAlgo, cryptoUserPass);
    var dec = decipher.update(idCode,'hex','utf8');
    dec += decipher.final('utf8');

    return dec;
};
